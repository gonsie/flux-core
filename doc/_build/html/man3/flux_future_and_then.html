

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flux_future_and_then(3) &mdash; flux-core  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="flux_future_create(3)" href="flux_future_create.html" />
    <link rel="prev" title="flux_flags_set(3)" href="flux_flags_set.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> flux-core
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual pages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../man1/index.html">man1</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">man3</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="flux_attr_get.html">flux_attr_get(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_aux_set.html">flux_aux_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_child_watcher_create.html">flux_child_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_content_load.html">flux_content_load(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_core_version.html">flux_core_version(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_decode.html">flux_event_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_publish.html">flux_event_publish(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_subscribe.html">flux_event_subscribe(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_fatal_set.html">flux_fatal_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_fd_watcher_create.html">flux_fd_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_flags_set.html">flux_flags_set(3)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">flux_future_and_then(3)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#return-value">RETURN VALUE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errors">ERRORS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resources">RESOURCES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">SEE ALSO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_create.html">flux_future_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_get.html">flux_future_get(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_wait_all_create.html">flux_future_wait_all_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_get_rank.html">flux_get_rank(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_get_reactor.html">flux_get_reactor(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_handle_watcher_create.html">flux_handle_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_idle_watcher_create.html">flux_idle_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_commit.html">flux_kvs_commit(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_copy.html">flux_kvs_copy(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_getroot.html">flux_kvs_getroot(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_lookup.html">flux_kvs_lookup(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_namespace_create.html">flux_kvs_namespace_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_txn_create.html">flux_kvs_txn_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_log.html">flux_log(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_cmp.html">flux_msg_cmp(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_encode.html">flux_msg_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_handler_addvec.html">flux_msg_handler_addvec(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_handler_create.html">flux_msg_handler_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_open.html">flux_open(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_periodic_watcher_create.html">flux_periodic_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_pollevents.html">flux_pollevents(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_reactor_create.html">flux_reactor_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_reactor_now.html">flux_watcher_now(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_recv.html">flux_recv(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_request_decode.html">flux_request_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_request_encode.html">flux_request_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_requeue.html">flux_requeue(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_respond.html">flux_respond(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_response_decode.html">flux_response_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_rpc.html">flux_rpc(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_send.html">flux_send(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_completion_ref.html">flux_shell_add_completion_ref(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_event_context.html">flux_shell_add_event_context(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_event_handler.html">flux_shell_add_event_handler(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_aux_set.html">flux_shell_aux_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_current_task.html">flux_shell_current_task(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_get_flux.html">flux_shell_get_flux(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_get_info.html">flux_shell_get_info(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_getenv.html">flux_shell_getenv(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_getopt.html">flux_shell_getopt(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_killall.html">flux_shell_killall(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_log.html">flux_shell_log(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_plugstack_call.html">flux_shell_plugstack_call(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_rpc_pack.html">flux_shell_rpc_pack(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_service_register.html">flux_shell_service_register(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_channel_subscribe.html">flux_shell_task_channel_subscribe(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_get_info.html">flux_shell_task_get_info(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_subprocess.html">flux_shell_task_subprocess(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_signal_watcher_create.html">flux_signal_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_stat_watcher_create.html">flux_stat_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_timer_watcher_create.html">flux_timer_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_watcher_start.html">flux_watcher_start(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_zmq_watcher_create.html">flux_zmq_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="idset_create.html">idset_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="idset_encode.html">idset_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="JSON_PACK.html">ENCODING JSON PAYLOADS</a></li>
<li class="toctree-l2"><a class="reference internal" href="JSON_UNPACK.html">DECODING JSON PAYLOADS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man5/index.html">man5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man7/index.html">man7</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/flux.html">flux package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/flux.core.html">flux.core package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/modules.html">python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/setup.html">setup module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">flux-core</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">man3</a> &raquo;</li>
        
      <li>flux_future_and_then(3)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/man3/flux_future_and_then.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flux-future-and-then-3">
<h1>flux_future_and_then(3)<a class="headerlink" href="#flux-future-and-then-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;flux/core.h&gt;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">flux_future_and_then</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span>
                                     <span class="n">flux_continuation_f</span> <span class="n">cb</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
<span class="n">flux_future_t</span> <span class="o">*</span><span class="n">flux_future_or_then</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span>
                                    <span class="n">flux_continuation_f</span> <span class="n">cb</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">flux_future_continue</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">prev</span><span class="p">,</span> <span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="n">void</span> <span class="n">flux_future_continue_error</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">prev</span><span class="p">,</span> <span class="nb">int</span> <span class="n">errnum</span><span class="p">,</span>
                                 <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">errstr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">flux_future_get(3)</span></code> for general functions that operate on futures,
and <code class="docutils literal notranslate"><span class="pre">flux_future_create(3)</span></code> for a description of the <code class="docutils literal notranslate"><span class="pre">flux_future_t</span></code>
base type. This page covers functions for the sequential composition of
futures, i.e. chains of dependent futures.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_and_then(3)</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">flux_future_then(3)</span></code>, but
returns a future that may later be &quot;continued&quot; from the continuation
callback <code class="docutils literal notranslate"><span class="pre">cb</span></code>. The provided continuation callback <code class="docutils literal notranslate"><span class="pre">cb</span></code> is only
executed when the future argument <code class="docutils literal notranslate"><span class="pre">f</span></code> is fulfilled successfully. On
error, the error from <code class="docutils literal notranslate"><span class="pre">f</span></code> is automatically propagated to the &quot;next&quot;
future in the chain (returned by the function).</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> is useful when a series of asynchronous
operations, each returning a <code class="docutils literal notranslate"><span class="pre">flux_future_t</span></code>, depend on the result
of a previous operation. That is, <code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> returns a
placeholder future for an eventual future that can't be created until
the continuation <code class="docutils literal notranslate"><span class="pre">cb</span></code> is run. The returned future can then be
used as a synchronization handle or even passed to another
<code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> in the chain. By default, the next future
in the chain will be fulfilled immediately using the result of the
previous future after return from the callback <code class="docutils literal notranslate"><span class="pre">cb</span></code>. Most callbacks,
however, should use either <code class="docutils literal notranslate"><span class="pre">flux_future_continue(3)</span></code> or
<code class="docutils literal notranslate"><span class="pre">flux_future_continue_error(3)</span></code> to pass an intermediate future
to use in fulfillment of the next future in the chain.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_or_then(3)</span></code> is like <code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code>, except
the continuation callback <code class="docutils literal notranslate"><span class="pre">cb</span></code> is run when the future <code class="docutils literal notranslate"><span class="pre">f</span></code> is fulfilled
with an error. This function is useful for recovery or other error
handling (other than the default behavior of propagating an error
down the chain to the final result). The <code class="docutils literal notranslate"><span class="pre">flux_future_or_then()</span></code>
callback offers a chance to successfully fulfill the &quot;next&quot; future
in the chain, even when the &quot;previous&quot; future was fulfilled with
an error.</p>
<p>As with <code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> the continuation
<code class="docutils literal notranslate"><span class="pre">cb</span></code> function for <code class="docutils literal notranslate"><span class="pre">flux_future_or_then()</span></code> should call
<code class="docutils literal notranslate"><span class="pre">flux_future_continue()</span></code> or <code class="docutils literal notranslate"><span class="pre">flux_future_continue_error()</span></code>, or
the result of the previous future will be propagated immediately
to the next future in the chain.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_continue(3)</span></code> continues the next future embedded in <code class="docutils literal notranslate"><span class="pre">prev</span></code>
(created by <code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> or <code class="docutils literal notranslate"><span class="pre">flux_future_or_then()</span></code>) with
the eventual result of the provided future <code class="docutils literal notranslate"><span class="pre">f</span></code>. This allows a future
that was not created until the context of the callback to continue
a sequential chain of futures created earlier. After the call to
<code class="docutils literal notranslate"><span class="pre">flux_future_continue(3)</span></code> completes, the future <code class="docutils literal notranslate"><span class="pre">prev</span></code> may safely be
destroyed. <code class="docutils literal notranslate"><span class="pre">flux_future_continue(3)</span></code> may be called with <code class="docutils literal notranslate"><span class="pre">f</span></code> equal
to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if the caller desires the next future in the chain to
<strong>not</strong> be fulfilled, in order to disable the automatic fulfillment
that normally occurs for non-continued futures after the callback
completes.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_continue_error(3)</span></code> is like <code class="docutils literal notranslate"><span class="pre">flux_future_continue()</span></code>
but immediately fulfills the next future in the chain with an error and
an optional error string. Once <code class="docutils literal notranslate"><span class="pre">flux_future_continue_error(3)</span></code>
completes, the future <code class="docutils literal notranslate"><span class="pre">prev</span></code> may safely be destroyed.</p>
</div>
<div class="section" id="return-value">
<h2>RETURN VALUE<a class="headerlink" href="#return-value" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_and_then()</span></code> and <code class="docutils literal notranslate"><span class="pre">flux_future_or_then()</span></code> return a <code class="docutils literal notranslate"><span class="pre">flux_future_t</span></code>
on success, or NULL on error. If both functions are called on the same
future, the returned <code class="docutils literal notranslate"><span class="pre">flux_future_t</span></code> from each will be the same object.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_continue()</span></code> returns 0 on success, or -1 on error with errno
set.</p>
</div>
<div class="section" id="errors">
<h2>ERRORS<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>ENOMEM</dt><dd><p>Out of memory.</p>
</dd>
<dt>EINVAL</dt><dd><p>Invalid argument.</p>
</dd>
<dt>ENOENT</dt><dd><p>The requested object is not found.</p>
</dd>
</dl>
</div>
<div class="section" id="resources">
<h2>RESOURCES<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>Github: <a class="reference external" href="http://github.com/flux-framework">http://github.com/flux-framework</a></p>
</div>
<div class="section" id="see-also">
<h2>SEE ALSO<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p>flux_future_get(3), flux_future_create(3)</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="flux_future_create.html" class="btn btn-neutral float-right" title="flux_future_create(3)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flux_flags_set.html" class="btn btn-neutral float-left" title="flux_flags_set(3)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2014 Lawrence Livermore National Security, LLC and Flux developers.

SPDX-License-Identifier: LGPL-3.0

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>