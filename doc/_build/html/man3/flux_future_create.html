

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flux_future_create(3) &mdash; flux-core  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="flux_future_get(3)" href="flux_future_get.html" />
    <link rel="prev" title="flux_future_and_then(3)" href="flux_future_and_then.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> flux-core
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual pages</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../man1/index.html">man1</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">man3</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="flux_attr_get.html">flux_attr_get(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_aux_set.html">flux_aux_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_child_watcher_create.html">flux_child_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_content_load.html">flux_content_load(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_core_version.html">flux_core_version(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_decode.html">flux_event_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_publish.html">flux_event_publish(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_event_subscribe.html">flux_event_subscribe(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_fatal_set.html">flux_fatal_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_fd_watcher_create.html">flux_fd_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_flags_set.html">flux_flags_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_and_then.html">flux_future_and_then(3)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">flux_future_create(3)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reactor-contexts">REACTOR CONTEXTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#return-value">RETURN VALUE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errors">ERRORS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resources">RESOURCES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">SEE ALSO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_get.html">flux_future_get(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_future_wait_all_create.html">flux_future_wait_all_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_get_rank.html">flux_get_rank(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_get_reactor.html">flux_get_reactor(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_handle_watcher_create.html">flux_handle_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_idle_watcher_create.html">flux_idle_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_commit.html">flux_kvs_commit(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_copy.html">flux_kvs_copy(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_getroot.html">flux_kvs_getroot(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_lookup.html">flux_kvs_lookup(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_namespace_create.html">flux_kvs_namespace_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_kvs_txn_create.html">flux_kvs_txn_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_log.html">flux_log(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_cmp.html">flux_msg_cmp(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_encode.html">flux_msg_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_handler_addvec.html">flux_msg_handler_addvec(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_msg_handler_create.html">flux_msg_handler_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_open.html">flux_open(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_periodic_watcher_create.html">flux_periodic_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_pollevents.html">flux_pollevents(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_reactor_create.html">flux_reactor_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_reactor_now.html">flux_watcher_now(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_recv.html">flux_recv(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_request_decode.html">flux_request_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_request_encode.html">flux_request_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_requeue.html">flux_requeue(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_respond.html">flux_respond(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_response_decode.html">flux_response_decode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_rpc.html">flux_rpc(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_send.html">flux_send(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_completion_ref.html">flux_shell_add_completion_ref(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_event_context.html">flux_shell_add_event_context(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_add_event_handler.html">flux_shell_add_event_handler(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_aux_set.html">flux_shell_aux_set(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_current_task.html">flux_shell_current_task(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_get_flux.html">flux_shell_get_flux(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_get_info.html">flux_shell_get_info(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_getenv.html">flux_shell_getenv(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_getopt.html">flux_shell_getopt(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_killall.html">flux_shell_killall(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_log.html">flux_shell_log(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_plugstack_call.html">flux_shell_plugstack_call(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_rpc_pack.html">flux_shell_rpc_pack(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_service_register.html">flux_shell_service_register(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_channel_subscribe.html">flux_shell_task_channel_subscribe(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_get_info.html">flux_shell_task_get_info(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_shell_task_subprocess.html">flux_shell_task_subprocess(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_signal_watcher_create.html">flux_signal_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_stat_watcher_create.html">flux_stat_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_timer_watcher_create.html">flux_timer_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_watcher_start.html">flux_watcher_start(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_zmq_watcher_create.html">flux_zmq_watcher_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="idset_create.html">idset_create(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="idset_encode.html">idset_encode(3)</a></li>
<li class="toctree-l2"><a class="reference internal" href="JSON_PACK.html">ENCODING JSON PAYLOADS</a></li>
<li class="toctree-l2"><a class="reference internal" href="JSON_UNPACK.html">DECODING JSON PAYLOADS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man5/index.html">man5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man7/index.html">man7</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/flux.html">flux package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/flux.core.html">flux.core package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/modules.html">python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bindings/python/setup.html">setup module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">flux-core</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">man3</a> &raquo;</li>
        
      <li>flux_future_create(3)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/man3/flux_future_create.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flux-future-create-3">
<h1>flux_future_create(3)<a class="headerlink" href="#flux-future-create-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>SYNOPSIS<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;flux/core.h&gt;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">flux_future_init_f</span><span class="p">)(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span>
                                   <span class="n">flux_reactor_t</span> <span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">flux_future_create</span> <span class="p">(</span><span class="n">flux_future_init_f</span> <span class="n">cb</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_fulfill</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span>
                          <span class="n">void</span> <span class="o">*</span><span class="n">result</span><span class="p">,</span> <span class="n">flux_free_f</span> <span class="n">free_fn</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_fulfill_error</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="nb">int</span> <span class="n">errnum</span><span class="p">,</span>
                                <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">errstr</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_fulfill_with</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">flux_future_t</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_fatal_error</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="nb">int</span> <span class="n">errnum</span><span class="p">,</span>
                              <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">errstr</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="o">*</span><span class="n">flux_future_aux_get</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">flux_future_aux_set</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
                         <span class="n">void</span> <span class="o">*</span><span class="n">aux</span><span class="p">,</span> <span class="n">flux_free_f</span> <span class="n">destroy</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_set_reactor</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">flux_t</span> <span class="o">*</span><span class="n">h</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flux_reactor_t</span> <span class="o">*</span><span class="n">flux_future_get_reactor</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">flux_future_set_flux</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="n">flux_t</span> <span class="o">*</span><span class="n">h</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flux_t</span> <span class="o">*</span><span class="n">flux_future_get_flux</span> <span class="p">(</span><span class="n">flux_future_t</span> <span class="o">*</span><span class="n">f</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>DESCRIPTION<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">flux_future_get(3)</span></code> for general functions that operate on futures.
This page covers functions primarily used when building classes that
return futures.</p>
<p>A Flux future represents some activity that may be completed with reactor
watchers and/or message handlers. It is intended to be returned by other
classes as a handle for synchronization and a container for results.
This page describes the future interfaces used by such classes.</p>
<p>A class that returns a future usually provides a creation function
that internally calls <code class="docutils literal notranslate"><span class="pre">flux_future_create()</span></code>, and may provide functions
to access class-specific result(s), that internally call <code class="docutils literal notranslate"><span class="pre">flux_future_get()</span></code>.
The create function internally registers a <em>flux_future_init_f</em>
function that is called lazily by the future implementation to perform
class-specific reactor setup, such as installing watchers and message
handlers.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_create()</span></code> creates a future and registers the
class-specific initialization callback <em>cb</em>, and an opaque argument
<em>arg</em> that will be passed to <em>cb</em>. The purpose of the initialization
callback is to set up class-specific watchers on a reactor obtained
with <code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code>, or message handlers on a flux_t
handle obtained with <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code>, or both.
<code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code> return
different results depending on whether the initialization callback is
triggered by a user calling <code class="docutils literal notranslate"><span class="pre">flux_future_then()</span></code> or
<code class="docutils literal notranslate"><span class="pre">flux_future_wait_for()</span></code>. The function may be triggered in one or
both contexts, at most once for each. The watchers or message
handlers must eventually call <code class="docutils literal notranslate"><span class="pre">flux_future_fulfill()</span></code>,
<code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_error()</span></code>, or <code class="docutils literal notranslate"><span class="pre">flux_future_fatal_error()</span></code> to
fulfill the future. See REACTOR CONTEXTS below for more information.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill()</span></code> fulfills the future, assigning an opaque
<em>result</em> value with optional destructor <em>free_fn</em> to the future.
A NULL <em>result</em> is valid and also fulfills the future. The <em>result</em>
is contained within the future and can be accessed with <code class="docutils literal notranslate"><span class="pre">flux_future_get()</span></code>
as needed until the future is destroyed.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_error()</span></code> fulfills the future, assigning an
<em>errnum</em> value and an optional error string. After the future is
fulfilled with an error, <code class="docutils literal notranslate"><span class="pre">flux_future_get()</span></code> will return -1 with errno
set to <em>errnum</em>.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code> fulfills the target future <em>f</em> using a
fulfilled future <em>p</em>. This function copies the pending result or error
from <em>p</em> into <em>f</em>, and adds read-only access to the <em>aux</em> items for <em>p</em>
from <em>f</em>. This ensures that any <code class="docutils literal notranslate"><span class="pre">get</span></code> method which requires <em>aux</em> items
for <em>p</em> will work with <em>f</em>. This function takes a reference to the source
future <em>p</em>, so it safe to call <code class="docutils literal notranslate"><span class="pre">flux_future_destroy</span> <span class="pre">(p)</span></code> after this call.
<code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code> returns -1 on error with <em>errno</em>
set on failure.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill()</span></code>, <code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code>, and
<code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_error()</span></code> can be called multiple times to queue
multiple results or errors. When callers access future results via
<code class="docutils literal notranslate"><span class="pre">flux_future_get()</span></code>, results or errors will be returned in FIFO order.
It is an error to call <code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code> multiple times on
the same target future <em>f</em> with a different source future <em>p</em>.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fatal_error()</span></code> fulfills the future, assigning an <em>errnum</em>
value and an optional error string. Unlike
<code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_error()</span></code> this fulfillment can only be called once
and takes precedence over all other fulfillments. It is used for
catastrophic error paths in future fulfillment.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_aux_set()</span></code> attaches application-specific data
to the parent object <em>f</em>. It stores data <em>aux</em> by key <em>name</em>,
with optional destructor <em>destroy</em>. The destructor, if non-NULL,
is called when the parent object is destroyed, or when
<em>key</em> is overwritten by a new value. If <em>aux</em> is NULL,
the destructor for a previous value, if any is called,
but no new value is stored. If <em>name</em> is NULL,
<em>aux</em> is stored anonymously.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_aux_get()</span></code> retrieves application-specific data
by <em>name</em>. If the data was stored anonymously, it
cannot be retrieved.</p>
<p>Names beginning with &quot;flux::&quot; are reserved for internal use.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_set_reactor()</span></code> may be used to associate a Flux reactor
with a future. The reactor (or a temporary one, depending on the context)
may be retrieved using <code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_set_flux()</span></code> may be used to associate a Flux broker handle
with a future. The handle (or a clone associated with a temporary reactor,
depending on the context) may be retrieved using <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code>.</p>
<p>Futures may &quot;contain&quot; other futures, to arbitrary depth. That is, an
init callback may create futures and use their continuations to fulfill
the containing future in the same manner as reactor watchers and message
handlers.</p>
</div>
<div class="section" id="reactor-contexts">
<h2>REACTOR CONTEXTS<a class="headerlink" href="#reactor-contexts" title="Permalink to this headline">¶</a></h2>
<p>Internally, a future can operate in two reactor contexts. The initialization
callback may be called in either or both contexts, depending on which
synchronization functions are called by the user. <code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code>
and <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code> return a result that depends on which context
they are called from.</p>
<p>When the user calls <code class="docutils literal notranslate"><span class="pre">flux_future_then()</span></code>, this triggers a call to the
initialization callback. The callback would typically call
<code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code> and/or <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code> to obtain the
reactor or flux_t handle to be used to set up watchers or message handlers.
In this context, the reactor or flux_t handle are exactly the ones passed
to <code class="docutils literal notranslate"><span class="pre">flux_future_set_reactor()</span></code> and <code class="docutils literal notranslate"><span class="pre">flux_future_set_flux()</span></code>.</p>
<p>When the user calls <code class="docutils literal notranslate"><span class="pre">flux_future_wait_for()</span></code>, this triggers the creation
of a temporary reactor, then a call to the initialization callback.
The temporary reactor allows these functions to wait <em>only</em> for the future's
events, without allowing unrelated watchers registered in the main reactor
to run, which might complicate the application's control flow. In this
context, <code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code> returns the temporary reactor, not
the one passed in with <code class="docutils literal notranslate"><span class="pre">flux_future_set_reactor()</span></code>. <code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code>
returns a temporary flux_t handle cloned from the one passed to
<code class="docutils literal notranslate"><span class="pre">flux_future_set_flux()</span></code>, and associated with the temporary reactor.
After the internal reactor returns, any messages unmatched by the dispatcher
on the cloned handle are requeued in the main flux_t handle with
<code class="docutils literal notranslate"><span class="pre">flux_dispatch_requeue()</span></code>.</p>
<p>Since the init callback may be made in either reactor context (at most once
each), and is unaware of which context that is, it should take care when
managing any context-specific state not to overwrite the state from a prior
call. The ability to attach objects with destructors anonymously to the future
with <code class="docutils literal notranslate"><span class="pre">flux_future_aux_set()</span></code> may be useful for managing the life cycle
of reactor watchers and message handlers created by init callbacks.</p>
</div>
<div class="section" id="return-value">
<h2>RETURN VALUE<a class="headerlink" href="#return-value" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_create()</span></code> returns a future on success. On error, NULL is
returned and errno is set appropriately.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_aux_set()</span></code> returns zero on success. On error, -1 is
returned and errno is set appropriately.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_aux_get()</span></code> returns the requested object on success. On
error, NULL is returned and errno is set appropriately.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_get_flux()</span></code> returns a flux_t handle on success. On error,
NULL is returned and errno is set appropriately.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_get_reactor()</span></code> returns a flux_reactor_t on success. On error,
NULL is returned and errno is set appropriately.</p>
<p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code> returns zero on success. On error, -1 is
returned with errno set to EINVAL if either <em>f</em> or <em>p</em> is NULL, or
<em>f</em> and <em>p</em> are the same, EAGAIN if the future <em>p</em> is not ready, or
EEXIST if the function is called multiple times with different <em>p</em>.</p>
</div>
<div class="section" id="errors">
<h2>ERRORS<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>ENOMEM</dt><dd><p>Out of memory.</p>
</dd>
<dt>EINVAL</dt><dd><p>Invalid argument.</p>
</dd>
<dt>ENOENT</dt><dd><p>The requested object is not found.</p>
</dd>
<dt>EAGAIN</dt><dd><p>The requested operation is not ready. For <code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code>,
the target future <em>p</em> is not fulfilled.</p>
</dd>
<dt>EEXIST</dt><dd><p><code class="docutils literal notranslate"><span class="pre">flux_future_fulfill_with()</span></code> was called multiple times with a different
target future <em>p</em>.</p>
</dd>
</dl>
</div>
<div class="section" id="resources">
<h2>RESOURCES<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>Github: <a class="reference external" href="http://github.com/flux-framework">http://github.com/flux-framework</a></p>
</div>
<div class="section" id="see-also">
<h2>SEE ALSO<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p>flux_future_get(3), flux_clone(3)</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="flux_future_get.html" class="btn btn-neutral float-right" title="flux_future_get(3)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flux_future_and_then.html" class="btn btn-neutral float-left" title="flux_future_and_then(3)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright Copyright 2014 Lawrence Livermore National Security, LLC and Flux developers.

SPDX-License-Identifier: LGPL-3.0

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>